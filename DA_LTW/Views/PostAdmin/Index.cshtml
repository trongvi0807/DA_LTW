@model IEnumerable<DA_LTW.Models.post>
@{
    ViewBag.Title = "Quản lý bài viết";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<style>
    /* Palette: nền ngọc trai nhẹ, accent xanh dịu */
    :root {
        --pearl-bg: #f6f4f1; /* nền tổng */
        --card-bg: #ffffff; /* nền vùng chứa */
        --muted: #7b766f; /* chữ phụ */
        --accent: #6aa89e; /* nút chính */
        --accent-dark: #568f7f;
        --border: #e7e4df; /* viền nhẹ */
        --badge-draft: #cfc9c2;
    }

    body {
        background: var(--pearl-bg);
        font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial;
        color: #222;
    }

    .admin-wrap {
        max-width: 1100px;
        margin: 32px auto;
        padding: 28px;
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(30,30,30,0.06);
        border: 1px solid var(--border);
    }

    .admin-head {
        display: flex;
        gap: 16px;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 18px;
    }

    .admin-title {
        display: flex;
        flex-direction: column;
    }

        .admin-title h2 {
            margin: 0;
            font-size: 1.4rem;
            letter-spacing: 0.2px;
            color: #2f2b28;
        }

        .admin-title p {
            margin: 4px 0 0;
            color: var(--muted);
            font-size: 0.95rem;
        }

    .btn-primary {
        display: inline-block;
        background: linear-gradient(180deg,var(--accent), var(--accent-dark));
        color: #fff;
        padding: 10px 16px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        border: none;
        box-shadow: 0 6px 14px rgba(106,168,158,0.14);
        transition: transform .12s ease, box-shadow .12s ease;
    }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(86,143,127,0.12);
        }

    /* Table */
    .table-wrap {
        width: 100%;
        overflow-x: auto;
    }

    table td img {
        width: 80px;
        height: 50px;
        object-fit: cover;
        border-radius: 6px;
        border: 1px solid var(--border);
    }

    table.post-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 720px;
    }

        table.post-table th,
        table.post-table td {
            padding: 12px 14px;
            text-align: left;
            vertical-align: middle;
            border-bottom: 1px solid var(--border);
            font-size: 0.95rem;
        }

        table.post-table thead th {
            background: linear-gradient(180deg, rgba(250,248,246,0.7), rgba(245,243,241,0.7));
            color: #3a3836;
            font-weight: 700;
            font-size: 0.95rem;
        }

    .title-cell {
        max-width: 460px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .meta {
        color: var(--muted);
        font-size: 0.88rem;
    }

    /* Badges */
    .badge {
        display: inline-block;
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 0.82rem;
        font-weight: 600;
        color: #fff;
    }

    .badge-published {
        background: var(--accent);
    }

    .badge-draft {
        background: var(--badge-draft);
        color: #3f3a36;
    }

    /* Action buttons */
    .actions {
        display: flex;
        gap: 8px;
    }

    .btn-sm {
        padding: 6px 10px;
        border-radius: 8px;
        font-size: 0.86rem;
        cursor: pointer;
        border: 1px solid transparent;
        text-decoration: none;
        color: #2f2b28;
        background: #fff;
        box-shadow: 0 2px 6px rgba(40,40,40,0.03);
    }

    .btn-edit {
        border-color: #d8efe8;
        color: var(--accent-dark);
    }

    .btn-delete {
        border-color: #f0d6d6;
        color: #b54b4b;
    }

    .btn-sm:hover {
        transform: translateY(-2px);
        transition: .12s ease;
    }

    /* Empty state */
    .empty {
        text-align: center;
        color: var(--muted);
        padding: 32px 8px;
    }

    /* Responsive */
    @@media (max-width: 800px) {
        .admin-head {
            flex-direction: column;
            align-items: stretch;
            gap: 12px;
        }

        .admin-title p {
            font-size: 0.9rem;
        }

        table.post-table {
            min-width: 600px;
        }
    }
</style>

<div class="admin-wrap">
    <div class="admin-head">
        <div class="admin-title">
            <h2>Quản lý bài viết</h2>
            <p>Danh sách bài viết — quản lý, sửa, xóa hoặc xuất bản nhanh</p>
        </div>

        <div class="admin-actions">
            <a class="btn-primary" href="@Url.Action("Create", "PostAdmin")">+ Thêm bài mới</a>
        </div>
    </div>

    <div class="table-wrap">
        @if (Model == null || !Model.Any())
        {
            <div class="empty">
                <p>Chưa có bài viết nào. Nhấn <strong>Thêm bài mới</strong> để tạo bài.</p>
            </div>
        }
        else
        {
            <table class="post-table"  aria-label="Danh sách bài viết">
                <thead>
                    <tr>
                        <th>Ảnh</th>
                        <th style="width:56%;">Tiêu đề</th>
                        <th style="width:12%;">Trạng thái</th>
                        <th style="width:16%;">Ngày tạo</th>
                        <th style="width:16%;">Thao tác</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var post in Model)
                    {
                        <tr>
                            <td>
                                @if (!string.IsNullOrEmpty(post.thumbnail_url))
                                {
                                    <img src="@post.thumbnail_url" alt="@post.title" />
                                }
                                else
                                {
                                    <span style="color:#aaa; font-size:13px;">(Không có ảnh)</span>
                                }
                            </td>
                            <td class="title-cell">
                                <div style="display:flex; flex-direction:column;">
                                    <span style="font-weight:600; color:#2b2a29;">@post.title</span>
                                    <span class="meta">@(!String.IsNullOrEmpty(post.excerpt) ? post.excerpt : (post.content != null ? (post.content.Length > 120 ? post.content.Substring(0,120) + "..." : post.content) : ""))</span>
                                </div>
                            </td>

                            <td>
                                <span class="badge @(post.status == "PUBLISHED" ? "badge-published" : "badge-draft")">
                                    @post.status
                                </span>
                            </td>

                            <td>
                                @{
                                    var created = post.created_at;
                                }
                                <span class="meta">
                                    @(
                                    created != null ? String.Format("{0:dd/MM/yyyy}", created) : ""
                                )
                                </span>
                            </td>

                            <td>
                                <div class="actions">
                                    <a class="btn-sm btn-edit" href="@Url.Action("Edit", "PostAdmin", new { id = post.id })">Sửa</a>
                                    <a class="btn-sm btn-delete" href="@Url.Action("Delete", "PostAdmin", new { id = post.id })"
                                       onclick="return confirm('Bạn có chắc muốn xóa bài này không?');">Xóa</a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
</div>
